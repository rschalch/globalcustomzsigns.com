!function(){$(document).ready(function(){window.location.href.match("/orders/add$")&&($.validator.addMethod("email_with_dot",function(e,t){return this.optional(t)||/^[a-z0-9]+([-._][a-z0-9]+)*@([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,4}$/.test(e)&&/^(?=.{1,64}@.{4,64}$)(?=.{6,100}$).*/.test(e)},"Please enter valid email address."),$("#form-add-order").validate({rules:{client:{required:!0,maxlength:45},client_address:{required:!0,maxlength:45},client_email:{required:!0,maxlength:45,email_with_dot:!0},client_phone:{required:!0,maxlength:25,phoneUS:!0},work:{required:!0},work_description:{required:!0,maxlength:400},logo:{required:!0},logo_delivery_date:{date:!0},pay_method:{required:!0},pay_total:{required:!0,number:!0},deposit:{required:!0,number:!0},balance:{required:!0,number:!0}},messages:{client:{required:"Field required",maxlength:"Max {0} characters"},client_address:{required:"Field required",maxlength:"Max {0} characters"},client_email:{required:"Field required",maxlength:"Max {0} characters",email:"Please enter a valid email address"},client_phone:{required:"Field required",maxlength:"Max {0} characters"},work_description:{required:"Field required",maxlength:"Max {0} characters"},logo_delivery_date:{date:"Please enter a valid date"}},highlight:function(e){$(e).closest(".form-group").addClass("has-error")},unhighlight:function(e){$(e).closest(".form-group").removeClass("has-error")},errorElement:"span",errorClass:"help-block",errorPlacement:function(e,t){t.parent(".input-group").length?e.insertAfter(t.parent()):e.insertAfter(t)}}),$("#datetimepicker1").datetimepicker({format:"MM/DD/YYYY"}),$("#logo_delivery_date").click(function(){$("#datetimepicker1").data("DateTimePicker").show()}))})}(),function(){$(document).ready(function(){window.location.href.match("/commissions$")&&($("#date1,#date2").datetimepicker({format:"MM/DD/YYYY",widgetPositioning:{vertical:"top",horizontal:"left"}}),$("#form_commission").validate({rules:{seller:{required:!0},option:{required:!0},date1:{required:"#optionsRadios5:checked"},date2:{required:"#optionsRadios5:checked"}},messages:{seller:{required:"Select a seller"},option:{required:"Select a calculation option"},date1:{required:"Select a start date"},date2:{required:"Select an end date"}},submitHandler:function(){var e;e="Custom"==$("input[name=option]:checked","#form_commission").val()?{seller:$("#seller").val(),option:$("input[name=option]:checked","#form_commission").val(),date1:$("#date1").val(),date2:$("#date2").val(),csrf_test_name:$.cookie("csrf_cookie_name")}:{seller:$("#seller").val(),option:$("input[name=option]:checked","#form_commission").val(),csrf_test_name:$.cookie("csrf_cookie_name")};var t=$.ajax({url:window.location.origin+"/commissions/calculate",method:"POST",data:e,dataType:"json"});t.success(function(e){$("#result").removeClass("hideme"),$("#result-seller").html(e.seller),$("#result-option").html(e.option),$("#result-total").html("$"+Number(e.total).toFixed(2)),$("#result-commission").html("$"+Number(e.commission).toFixed(2))}),t.fail(function(e,t){console.log("Request failed: "+t)})},errorElement:"div",errorLabelContainer:".errors",errorClass:"help-block"}),$("#seller").autocomplete({serviceUrl:"/commissions/sellers",onSelect:function(e){}}),$("input:radio:last").click(function(){$("#custom_dates").removeClass("hideme")}),$("input:radio:not(:last)").click(function(){$("#custom_dates").addClass("hideme")}))})}(),function(){$(document).ready(function(){$("#form-mail").validate({rules:{name:{required:!0,maxlength:20},phone:{required:!0,maxlength:18},email:{required:!0,maxlength:30,email:!0},subject:{required:!0,maxlength:20},message:{required:!0,maxlength:400}},messages:{name:{required:"Field required",maxlength:"Max {0} characters"},phone:{required:"Field required",maxlength:"Max {0} characters"},email:{required:"Field required",maxlength:"Max {0} characters",email:"Must be a valid e-mail!"},subject:{required:"Field required",maxlength:"Max {0} characters"},message:{required:"Field required",maxlength:"Max {0} characters"}}})})}(),function(){$(document).ready(function(){window.location.href.match("/auth/create_user$")&&$("#form-create-user").validate({rules:{email:{required:!0,maxlength:50,email:!0},password:{required:!0,minlength:8},password_confirm:{equalTo:"#password"}},messages:{email:{required:"Field required",maxlength:"Max {0} characters",email:"Must be a valid e-mail!"}},highlight:function(e){$(e).closest(".form-group").addClass("has-error")},unhighlight:function(e){$(e).closest(".form-group").removeClass("has-error")},errorElement:"span",errorClass:"help-block",errorPlacement:function(e,t){t.parent(".input-group").length?e.insertAfter(t.parent()):e.insertAfter(t)}})})}(),function(){$(document).ready(function(){if(window.location.href.match("/orders$")){var e,t,a,r,i=$("#orders"),o=$("#changeorder"),l=$.ajax({url:window.location.origin+"/auth/admin",method:"GET"});l.success(function(l){"success"==l?(r=!0,e='<span class="glyphicon glyphicon-trash"></span>'):(r=!1,e=""),$("#datetimepicker_date").datetimepicker({format:"MM/DD/YYYY"}),$("#datetimepicker_logo").datetimepicker({format:"MM/DD/YYYY"}),$("#datetimepicker_delivery").datetimepicker({format:"MM/DD/YYYY"});var n=function(){$.fn.dataTable.ext.search=[],orders.clear().draw(),orders.ajax.url("orders/orders").load()};$.fn.dataTable.moment("YYYY-MM-DD");var d=function(){$("#salesman").val(""),$("#date").val(""),$("#client").val(""),$("#client_address").val(""),$("#client_email").val(""),$("#client_phone").val(""),$("#work").val(""),$("#work_description").val(""),$("#logo").val(""),$("#logo_delivery_date").val(""),$("#pay_method").val(""),$("#pay_total").val(""),$("#deposit").val(""),$("#balance").val(""),$("#status").val("")};$.fn.dataTable.ext.buttons.customprint={extend:"print",text:"Print",customize:function(e){$(e.document.body).css("font-size","9pt"),$(e.document.body).find("table").addClass("compact").css("font-size","inherit"),$(e.document.body).find("thead").css("display","table-header-group")},exportOptions:{columns:[0,1,2,3,6,7,8,10,11,12,13,14]},key:{key:"p"}},$.fn.dataTable.ext.buttons.finalised={text:"Finalised",action:function(e,t,a,r){$.fn.dataTable.ext.search=[],t.draw(),$.fn.dataTable.ext.search.push(function(e,t,a){return"1"===t[14]?!0:!1}),t.draw(),t.button(2).active(!0),t.button(3).active(!1),t.button(4).active(!1)},key:{key:"f"},className:"filter-button"},$.fn.dataTable.ext.buttons.no_finalised={text:"No Finalised",action:function(e,t,a,r){$.fn.dataTable.ext.search=[],t.draw(),$.fn.dataTable.ext.search.push(function(e,t,a){return"0"===t[14]?!0:!1}),t.draw(),t.button(2).active(!1),t.button(3).active(!0),t.button(4).active(!1)},key:{key:"n"},className:"filter-button"},$.fn.dataTable.ext.buttons.all={text:"All",action:function(e,t,a,r){$.fn.dataTable.ext.search=[],t.draw(),t.button(2).active(!1),t.button(3).active(!1),t.button(4).active(!0)},key:{key:"a"},className:"filter-button"},$("#orders tfoot th:not(:last)").each(function(){var e=$(this).text();$(this).html('<input type="text" placeholder="Search '+e+'" class="form-control" />')}),orders=i.DataTable({dom:"<'row'<'col-md-2'l><'col-md-4'B><'col-md-6'f>><'row'<'col-md-12'tr>><'row'<'col-md-5'i><'col-md-7'p>>",searching:!0,paging:!0,pagingType:"full_numbers",info:!0,lengthChange:!0,buttons:["excel","customprint","finalised","no_finalised","all"],deferRender:!0,scrollY:"45vh",ajax:{url:"orders/orders",type:"POST",data:{csrf_test_name:$.cookie("csrf_cookie_name")}},columns:[{data:"id"},{data:"salesman"},{data:"date"},{data:"client"},{data:"client_address"},{data:"client_email"},{data:"client_phone"},{data:"work"},{data:"work_description"},{data:"logo"},{data:"pay_total"},{data:"deposit"},{data:"balance"},{data:"status"},{data:"finalised"},{data:null,defaultContent:e}],columnDefs:[{targets:0,width:"10%"},{targets:1,width:"10%"},{targets:2,width:"10%",orderable:!1},{targets:3,width:"15%",orderable:!1},{targets:4,visible:!1},{targets:5,visible:!1},{targets:6,visible:!1},{targets:7,width:"10%",orderable:!1},{targets:8,visible:!1},{targets:9,visible:!1},{targets:10,width:"5%",orderable:!1},{targets:11,width:"5%",orderable:!1},{targets:12,width:"5%",orderable:!1},{render:function(e,t,a){return null!==e?e.split("<br><span class='date'>").pop():""},targets:13,width:"30%",orderable:!1},{targets:14,visible:!1},{targets:15,width:"0%",orderable:!1}],drawCallback:function(){i.find("tbody").find(".glyphicon-trash").on("click",function(e){e.stopPropagation();var a=orders.row($(this).parents("tr")).data();t=a.id,$("#_modal_del_order_label").html("Exclude order?"),$("#_modal_del_order").modal("show"),$("#_modal_del_order").find(".modal-body").html("Exclude order of the client "+a.client+" ?")})},rowCallback:function(e,t,a){"1"==t.finalised&&orders.row(e).nodes().to$().addClass("danger")}}),orders.columns().every(function(){var e=this;$("input",this.footer()).on("keyup change",function(){e.search()!==this.value&&e.search(this.value).draw()})}),i.find("tbody").on("click","tr",function(){var e=orders.row(this).data();t=orders.row(this).data().id,"0"==orders.row(this).data().finalised?(d(),$("#change_order_title").html("EDIT ORDER "+t+":"),$("#salesman").val(e.salesman),$("#date").val(e.date),$("#client").val(e.client),$("#client_address").val(e.client_address),$("#client_email").val(e.client_email),$("#client_phone").val(e.client_phone),$("#work").val(e.work),$("#work_description").val(e.work_description),$("#logo").val(e.logo),$("#logo_delivery_date").val(e.logo_delivery_date),$("#pay_method").val(e.pay_method),$("#pay_total").val(e.pay_total),$("#deposit").val(e.deposit),$("#balance").val(e.balance),$("#status").val(""),$("#delivery_date").val(e.delivery_date),$("#finalised").val(e.finalised),$("#status_list").html(e.status),$("#_modal_update_order").modal("show")):($("#finalised_order_title").html("ORDER "+t+": FINALISED"),$("#fin_salesman").html(e.salesman),$("#fin_date").html(e.date),$("#fin_client").html(e.client),$("#fin_client_address").html(e.client_address),$("#fin_client_email").html(e.client_email),$("#fin_client_phone").html(e.client_phone),$("#fin_work").html(e.work),$("#fin_work_description").html(e.work_description),$("#fin_logo").html(e.logo),$("#fin_logo_delivery_date").html(e.logo_delivery_date),$("#fin_pay_method").html(e.pay_method),$("#fin_pay_total").html(e.pay_total),$("#fin_deposit").html(e.deposit),$("#fin_balance").html(e.balance),$("#fin_status").html(e.status),$("#fin_delivery_date").html(e.delivery_date),$("#_modal_finalised_order").modal("show"))}),$("#form_update_order").submit(function(e){e.preventDefault(),o.html("Changing..."),o.addClass("btn-success").removeClass("btn-primary"),a&&a.abort();var r=$(this),i=r.find("input, textarea"),l=r.serialize();i.prop("disabled",!0),a=$.ajax({url:"orders/update_order/"+t,type:"post",data:l}),a.fail(function(e,t,a){console.error("The following error occurred: "+t,a),$("#warning").removeClass("hideme")}),a.done(function(e,t,a){"success"==e&&($("#_modal_update_order").modal("hide"),n())}),a.always(function(){i.prop("disabled",!1),o.html("Change"),o.addClass("btn-primary").removeClass("btn-success")})}),$("#form_del_order").submit(function(e){e.preventDefault(),$("#delorder").html("Excluding..."),$("#delorder").addClass("btn-success").removeClass("btn-danger"),a&&a.abort();var r=$(this),i=r.serialize();a=$.ajax({url:"orders/delete_order/"+t,type:"post",data:i}),a.fail(function(e,t,a){console.error("The following error occurred: "+t,a),$("#warning").removeClass("hideme")}),a.done(function(e,t,a){"success"==e&&($("#_modal_del_order").modal("hide"),n())}),a.always(function(){$("#delorder").html("Exclude"),$("#delorder").addClass("btn-danger").removeClass("btn-success")})}),$("#reactivate").on("click",function(){var e=$.ajax({url:"/orders/reactivate/"+t,method:"GET"});e.success(function(e){"success"==e?($("#_modal_finalised_order").modal("hide"),n()):console.log("something wrong")})})}),l.fail(function(e,t){console.log("Request failed: "+t)})}})}();